%h1.title Editing #{@draft.form.name}
= form_for @draft do |f|
  %table#edit_draft
    %tr
      %td{ colspan: 5 }
        = f.label :name, 'Change form title:'
        = f.text_field :name, required: true, size: 50
    %tr
      %td{ colspan: 7 }
        = f.label :email, 'Change form email destination:'
        = f.text_field :email, required: true, size: 50
    %tr
      %th Field text
      %tr Example response
      %tr Response type
      %tr Required?
      %tr Options
  #flex_wrapper
    .flex_col
      = f.fields_for :fields do |g|
        - field = g.object
        - if field.new_record?
          .centered{ colspan: 5 } Add new field...
        .row.field
          = g.hidden_field :number
          = g.text_area :prompt, required: !field.new_record?, size: '35x4'
          = g.text_field :placeholder if field.takes_placeholder?
          = g.select :data_type, Field::DATA_TYPES,
            include_blank: 'Select a data type...',
            required: !field.new_record?
          = g.check_box :required
          - if field.data_type == 'options'
            - field.options.each do |option|
              = option
              = link_to 'Configure options', edit_field_path(field)
      .actions
        = f.submit 'Save changes and continue editing'
        = f.submit 'Preview changes'
    .flex_col
      - @draft.fields.each do |field|
        - unless field.new_record?
          .row.buttons
            - unless @draft.fields.index(field).zero?
              = button_to 'Move up',
                move_field_form_draft_path(@draft, number: field.number,
                                           direction: :up)
            - unless field == @draft.fields.not_new.last
              = button_to 'Move down',
                move_field_form_draft_path(@draft, number: field.number,
                                           direction: :down)
            = button_to 'Remove field',
              remove_field_form_draft_path(@draft, number: field.number)
